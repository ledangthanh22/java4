CREATE DATABASE FINALASS_FPOLYSHOP_FA22_SOF205__SOF2041
USE FINALASS_FPOLYSHOP_FA22_SOF205__SOF2041
GO
-- ChucVu
CREATE TABLE ChucVu(
Id INT PRIMARY KEY IDENTITY (1,1),
--Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL
)
INSERT INTO ChucVu(Ma,Ten) VALUES
('Cv1',N'Nhân viên'),
('Cv2',N'Quản lý');
SELECT * FROM ChucVu
GO
-- CuaHang
CREATE TABLE CuaHang(
--Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Id INT PRIMARY KEY IDENTITY (1,1) ,
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(50) DEFAULT NULL,
DiaChi NVARCHAR(100) DEFAULT NULL,
ThanhPho NVARCHAR(50) DEFAULT NULL,
QuocGia NVARCHAR(50) DEFAULT NULL
)
INSERT INTO CuaHang(Ma,Ten,DiaChi,ThanhPho,QuocGia) VALUES
('Ch1',N'ThanhShop',N'Đại Từ-Thái Nguyên',N'Thái Nguyên',N'Việt Nam'),
('Ch2',N'ThucShop',N'Hoàng Hóa-Thanh Hóa',N'Thanh Hóa',N'Việt Nam');
SELECT * FROM CuaHang
GO
-- NhanVien
CREATE TABLE NhanVien(
--Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Id INT PRIMARY KEY IDENTITY (1,1),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(30) DEFAULT NULL,
TenDem NVARCHAR(30) DEFAULT NULL,
Ho NVARCHAR(30) DEFAULT NULL,
GioiTinh BIT DEFAULT NULL,
NgaySinh DATE DEFAULT NULL,
DiaChi NVARCHAR(100) DEFAULT NULL,
Sdt VARCHAR(30) DEFAULT NULL,
MatKhau VARCHAR(MAX) DEFAULT NULL,
IdCH INT,
IdCV INT,
--IdCH UNIQUEIDENTIFIER,
--IdCV UNIQUEIDENTIFIER,
TrangThai INT DEFAULT 0
)
DROP TABLE ChucVu
DROP TABLE NhanVien
DROP TABLE CuaHang
DROP TABLE HoaDonChiTiet
DROP TABLE HoaDon
GO
INSERT INTO NhanVien(Ma,Ten,TenDem,Ho,GioiTinh,NgaySinh,Sdt,DiaChi,MatKhau,IdCH,IdCV) VALUES
('Kh1',N'Thành',N'Đăng',N'Lê','true','2002-06-22','0369958572',N'Đại Từ-Thái Nguyên','123',1,2),
('Kh2',N'Thực',N'Đăng',N'Lê','true','2002-10-22','0369958572',N'Hoàng Hóa-Thanh Hóa','153',2,1),
('Kh3',N'Dũng',N'Anh',N'Lê','true','2003-06-22','0369958572',N'Bắc Từ Liêm-Hà Nội','1efdb23',1,1);
SELECT * FROM NhanVien
SELECT * FROM ChucVu
SELECT * FROM CuaHang
-- KhachHang
CREATE TABLE KhachHang(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(30),
TenDem NVARCHAR(30) DEFAULT NULL,
Ho NVARCHAR(30) DEFAULT NULL,
NgaySinh DATE DEFAULT NULL,
Sdt VARCHAR(30) DEFAULT NULL,
DiaChi NVARCHAR(100) DEFAULT NULL,
ThanhPho NVARCHAR(50) DEFAULT NULL,
QuocGia NVARCHAR(50) DEFAULT NULL,
MatKhau VARCHAR(MAX) DEFAULT NULL
)
INSERT INTO KhachHang(Ma,Ten,TenDem,Ho,NgaySinh,Sdt,DiaChi,ThanhPho,QuocGia,MatKhau) VALUES
('Kh1',N'Thành',N'Đăng',N'Lê','2002-06-22','0369958572',N'Đại Từ-Thái Nguyên',N'Thái Nguyên',N'Việt Nam','123'),
('Kh2',N'Thực',N'Đăng',N'Lê','2002-10-22','0369958572',N'Hoàng Hóa-Thanh Hóa',N'Thanh Hóa',N'Việt Nam','153'),
('Kh3',N'Dũng',N'Anh',N'Lê','2003-06-22','0369958572',N'Bắc Từ Liêm-Hà Nội',N'Hà Nội',N'Việt Nam','1efdb23');
SELECT * FROM KhachHang
GO

--HoaDon
CREATE TABLE HoaDon(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdKH UNIQUEIDENTIFIER,
--IdNV UNIQUEIDENTIFIER,
IdNV INT,
Ma VARCHAR(20) UNIQUE,
NgayTao DATE DEFAULT NULL,
NgayThanhToan DATE DEFAULT NULL,
NgayShip DATE DEFAULT NULL,
NgayNhan DATE DEFAULT NULL,
TinhTrang INT DEFAULT 0,
TenNguoiNhan NVARCHAR(50) DEFAULT NULL,
DiaChi NVARCHAR(100) DEFAULT NULL,
Sdt VARCHAR(30) DEFAULT NULL,
)
GO
CREATE TABLE GioHang(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdKH UNIQUEIDENTIFIER,
IdNV UNIQUEIDENTIFIER,
Ma VARCHAR(20) UNIQUE,
NgayTao DATE DEFAULT NULL,
NgayThanhToan DATE DEFAULT NULL,
TenNguoiNhan NVARCHAR(50) DEFAULT NULL,
DiaChi NVARCHAR(100) DEFAULT NULL,
Sdt VARCHAR(30) DEFAULT NULL,
TinhTrang INT DEFAULT 0
)
GO
-- SanPham
CREATE TABLE SanPham(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(30)
)
INSERT INTO SanPham(Ma,Ten) VALUES
('SP1',N'giay-adidas-ultraboost-20'),
('SP2',N'giay-adidas-ultraboost-22'),
('SP3',N'giay-adidas-yeezy-boost-350'),
('SP4',N'giay-nam-air-jordan-1-low'),
('SP5',N'giay-nike-air-force-1-07'),
('SP6',N'giay-nike-air-force-1-low-sail'),
('SP7',N'giay-nike-air-force-1-low-uti'),
('SP8',N'giay-nike-air-jordan-1-mid-se'),
('SP9',N'giay-nike-air-jordan-1-retro'),
('SP10',N'giay-nike-dunk-low-se-just'),
('SP11',N'giay-vans-bedwin-the-heartbr'),
('SP12',N'giay-vans-og-authentic-lx'),
('SP13',N'giay-vans-og-style-36-lx'),
('SP14',N'Giay-Vans-Ua-Style-36-Decon'),
('SP15',N'Thiet-ke-chua-co-ten-2022-09');
SELECT * FROM SanPham
GO
-- NSX
CREATE TABLE NSX(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(30)
)
INSERT INTO NSX(Ma,Ten) VALUES
('nsx1',N'LeThanh'),
('nsx2',N'LeThuc'),
('nsx3',N'LeDung');
SELECT * FROM NSX
GO
-- MauSac
CREATE TABLE MauSac(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(30)
)
INSERT INTO MauSac(Ma,Ten) VALUES
('Ms1',N'Trắng'),
('Ms2',N'Đen'),
('Ms3',N'Đỏ');
SELECT * FROM MauSac
GO
-- DongSP
CREATE TABLE DongSP(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
Ma VARCHAR(20) UNIQUE,
Ten NVARCHAR(30)
)
GO
INSERT INTO DongSP(Ma,Ten) VALUES
('Dsp1',N'Nike'),
('Dsp2',N'Adidas'),
('Dsp4',N'Jordan'),
('Dsp3',N'Vans');
SELECT * FROM DongSP
-- ChiTietSP
CREATE TABLE ChiTietSP(
Id UNIQUEIDENTIFIER PRIMARY KEY DEFAULT NEWID(),
IdSP UNIQUEIDENTIFIER,
IdNsx UNIQUEIDENTIFIER,
IdMauSac UNIQUEIDENTIFIER,
IdDongSP UNIQUEIDENTIFIER,
NamBH INT DEFAULT NULL,
MoTa NVARCHAR(50) DEFAULT NULL,
SoLuongTon INT,
GiaNhap DECIMAL(20,0) DEFAULT 0,
GiaBan DECIMAL(20,0) DEFAULT 0,
Anh VARCHAR(250)
)
INSERT INTO ChiTietSP(IdSP,IdNsx,IdMauSac,IdDongSP,NamBH,MoTa,SoLuongTon,GiaNhap,GiaBan,Anh) VALUES
('1F7F787D-BA82-4AE5-BA3D-5748CB36D4DD','16C54FA9-7C92-437D-8B41-E563446268A1','FF478BAE-34D5-45E0-9E06-DC13CDDC93E5','97B7B4BE-2C18-41F4-8B6C-408FB3613D11',2023,'Dep vai o',1002,200000,300000,'anh1'),
('BF3C4753-41D8-42D8-8E34-473274CD20AF','16C54FA9-7C92-437D-8B41-E563446268A1','FF478BAE-34D5-45E0-9E06-DC13CDDC93E5','97B7B4BE-2C18-41F4-8B6C-408FB3613D11',2023,'Dep vai o',1002,200000,300000,'anh1'),
('72CE6702-3838-45A0-B5CB-40D5036CEF55','16C54FA9-7C92-437D-8B41-E563446268A1','FF478BAE-34D5-45E0-9E06-DC13CDDC93E5','97B7B4BE-2C18-41F4-8B6C-408FB3613D11',2023,'Dep vai o',1002,200000,300000,'anh1'),
('2BA85980-8D91-4EED-BB93-578A4B09CDF9','16C54FA9-7C92-437D-8B41-E563446268A1','FF478BAE-34D5-45E0-9E06-DC13CDDC93E5','97B7B4BE-2C18-41F4-8B6C-408FB3613D11',2023,'Dep vai o',1002,200000,300000,'anh1'),
('2552C1B6-CF6F-4410-97A7-65AFD25324EE','16C54FA9-7C92-437D-8B41-E563446268A1','FF478BAE-34D5-45E0-9E06-DC13CDDC93E5','97B7B4BE-2C18-41F4-8B6C-408FB3613D11',2023,'Dep vai o',1002,200000,300000,'anh1');



SELECT * FROM ChiTietSP
SELECT * FROM MauSac
SELECT * FROM DongSP
SELECT * FROM NSX
SELECT * FROM SanPham

GO

-- HoaDonChiTiet
CREATE TABLE HoaDonChiTiet(
IdHoaDon UNIQUEIDENTIFIER,
IdChiTietSP UNIQUEIDENTIFIER,
SoLuong INT,
DonGia DECIMAL(20,0) DEFAULT 0,
CONSTRAINT PK_HoaDonCT PRIMARY KEY (IdHoaDon,IdChiTietSP),
CONSTRAINT FK1 FOREIGN KEY(IdHoaDon) REFERENCES HoaDon(Id),
CONSTRAINT FK2 FOREIGN KEY(IdChiTietSP) REFERENCES ChiTietSP(Id),
)
GO
CREATE TABLE GioHangChiTiet(
IdGioHang UNIQUEIDENTIFIER,
IdChiTietSP UNIQUEIDENTIFIER,
SoLuong INT,
DonGia DECIMAL(20,0) DEFAULT 0,
DonGiaKhiGiam DECIMAL(20,0) DEFAULT 0,
CONSTRAINT PK_GioHangCT PRIMARY KEY (IdGioHang,IdChiTietSP),
CONSTRAINT FK1_IdGioHang FOREIGN KEY(IdGioHang) REFERENCES GioHang(Id),
CONSTRAINT FK2_IdChiTietSP FOREIGN KEY(IdChiTietSP) REFERENCES ChiTietSP(Id),
)
GO
--TẠO QUAN HỆ GIỮA CÁC BẢNG
--NhanVien - CuaHang
ALTER TABLE NhanVien ADD FOREIGN KEY (IdCH) REFERENCES CuaHang(Id)
--NhanVien - ChucVu
ALTER TABLE NhanVien ADD FOREIGN KEY (IdCV) REFERENCES ChucVu(Id)
-- HoaDon - KhachHang
ALTER TABLE HoaDon ADD FOREIGN KEY (IdKH) REFERENCES KhachHang(Id)
-- GioHang - KhachHang
ALTER TABLE GioHang ADD FOREIGN KEY (IdKH) REFERENCES KhachHang(Id)
-- HoaDon - NhanVien
ALTER TABLE HoaDon ADD FOREIGN KEY (IdNV) REFERENCES NhanVien(Id)
-- ChiTietSP - SanPham
ALTER TABLE ChiTietSP ADD FOREIGN KEY(IdSP) REFERENCES SanPham(Id)
-- ChiTietSP - NSX
ALTER TABLE ChiTietSP ADD FOREIGN KEY(IdNsx) REFERENCES Nsx(Id)
-- ChiTietSP - MauSac
ALTER TABLE ChiTietSP ADD FOREIGN KEY(IdMauSac) REFERENCES MauSac(Id)
-- ChiTietSP - DongSP
ALTER TABLE ChiTietSP ADD FOREIGN KEY(IdDongSP) REFERENCES DongSP(Id)
